@model DRMS_Models.ConstructionListModel
@{
    ViewBag.Title = "ConstructionList";
    Layout = "~/Views/Shared/_DRMSLayout.cshtml";
}

<style type="text/css">
    table.table tr.selected {
        background-color: #0e0beb !important;
        color: #fff;
        font-size: large;
    }

    .prjid {
        display: none;
    }
</style>

<canvas class='connecting-dots' id="experiment"></canvas>
<div class="container">
    <div class="container">
        <div class="wrapper">
            <form action="" method="post" name="Login_Form" class="form-signin">
                <h3 class="form-signin-heading">WEB日報管理システム</h3>

                <h4 class="form-signin-heading">工事一覧</h4>
                <hr class="colorgraph"><br>

                <table id="tblConstruction" tabindex="0" class="table table-hover table-striped header-fixed">
                    <tbody>
                    </tbody>
                </table>
                <div class="form-group pt-3">
                    <label for="x">出力期間</label>
                    <div class="datechoices input-daterange input-group">
                        <input class="form-control" id="txtstartDate" type="date" value="　">
                        <div class="input-group-addon">～</div>
                        <input class="form-control" id="txtendDate" type="date" value="　">
                    </div>
                    <div class="pt-2 text-center">
                        <button type="button" id="btn" class="btn btn-outline-secondary btn" data-pdfdata-url='@Url.Action("GetPDFData", "api/ConstructionListAPI")'>工事別明細出力</button>
                    </div>
                    <h5 id="companyname" class="text-right pt-4"></h5>
                </div>
            </form>
        </div>
    </div>
</div>

@*PDF PAGE STYLE*@
<div id="PrintDiv" class="container">
    <table id="tblPDF" class="table table-bordered table-striped header-fixed">
        <thead></thead>
        <tbody></tbody>
    </table>
</div>

@section Scripts
{
    <script src="@Url.Content("~/js/ConstructionList.js")"></script>

    <script type="text/javascript">
        $(document).ready(function (e) {
            window.prjCD = '';
            window.prjName = '';
            var response = CalltoApiController('@Url.Action("GetPrjData", "api/ConstructionListAPI")', null);
            BindData(JSON.parse(response));

            $("tbody tr").click(function () {
                $('.selected').removeClass('selected');
                $(this).addClass("selected");
                window.prjCD = $('.prjid', this).html();
                window.prjName = $('.prjname', this).html();
            });

            $("tbody tr").on("focusin", function () {
                $('.selected').removeClass('selected');
                $(this).addClass("selected");
                window.prjCD = $('.prjid', this).html();
                window.prjName = $('.prjname', this).html();
            });

            $('#btn').click(function () {
                btnClick();
            });
        });
    </script>
}